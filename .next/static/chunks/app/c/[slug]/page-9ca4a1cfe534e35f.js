(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[111],{3873:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>g});var n=i(6384),s=i(6636);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],[n,a]=(0,s.useState)(0),l=i?e.split(""):e.split(" ");return(0,s.useEffect)(()=>{a(0)},[e]),(0,s.useEffect)(()=>{if(n>=l.length)return;let e=setInterval(()=>{a(e=>e+1)},t);return()=>{clearInterval(e)}},[n,l,t]),l.slice(0,n).join(i?"":" ")};var l=i(5093);function o(e){let{onStartListening:t,onStopListening:i,isAudioPlaying:o,currentText:r}=e,[c,d]=(0,s.useState)("idle"),g=a(r,20),u=a("Click the circle to start the conversation",20);return(0,s.useEffect)(()=>{o?d("speaking"):"speaking"===c&&r&&d("listening")},[o]),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4",children:[(0,n.jsx)("div",{className:"relative mb-8 cursor-pointer",onClick:()=>{"listening"===c||"speaking"===c?(null==i||i(),d("idle")):o||(null==t||t(),d("listening"))},role:"button","aria-label":"listening"===c?"Stop listening":"Start listening",children:(0,n.jsx)(l.P.div,{className:"w-40 h-40 rounded-full overflow-hidden flex items-center justify-center",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,n.jsx)("img",{src:"/listening.gif",alt:"listening"===c?"AI is listening":"speaking"===c?"AI is speaking":"AI is idle",className:"w-full h-full object-cover"})})}),(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[(0,n.jsx)("p",{className:"text-gray-800 text-lg font-mono","aria-live":"polite",children:"listening"===c?"Listening...":"speaking"===c?g:u}),"idle"===c&&(0,n.jsx)(l.P.div,{animate:{opacity:[0,1,0]},transition:{duration:.8,repeat:1/0,ease:"easeInOut"},className:"h-5 w-2 bg-violet-600 mt-2"})]}),(0,n.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,n.jsx)("button",{onClick:()=>{o||(null==t||t(),d("listening"))},disabled:"listening"===c||"speaking"===c,className:"px-6 py-2 rounded-lg font-medium transition-colors ".concat("listening"===c||"speaking"===c?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-pink-500 to-violet-600 text-white hover:from-pink-600 hover:to-violet-700"),children:"Start"}),(0,n.jsx)("button",{onClick:()=>{("listening"===c||"speaking"===c)&&(null==i||i(),d("idle"))},disabled:"idle"===c,className:"px-6 py-2 rounded-lg font-medium transition-colors ".concat("idle"===c?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700"),children:"End"})]})]})}var r=i(1644),c=i(4582),d=i(4401);function g(){let{slug:e}=(0,c.useParams)(),[t,i]=(0,s.useState)(""),[a,l]=(0,s.useState)([]),[g,u]=(0,s.useState)(!1),p=()=>{fetch("/api/c?id=".concat(e)).then(e=>e.json()).then(e=>{e.length>0&&l(e.map(e=>({...e,formatted:{text:e.content_transcript,transcript:e.content_transcript}})))})},h=(0,r.L)({onError:e=>{(0,d.o)(e)},onConnect:()=>{(0,d.o)("Connected to ElevenLabs.")},onMessage:t=>{let{message:n,source:s}=t;"ai"===s&&i(n),fetch("/api/c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,item:{type:"message",status:"completed",object:"realtime.item",id:"item_"+Math.random(),role:"ai"===s?"assistant":"user",content:[{type:"text",transcript:n}]}})}).then(p)}}),m=(0,s.useCallback)(async()=>{(0,d.o)("Setting up ElevenLabs...");try{await navigator.mediaDevices.getUserMedia({audio:!0});let e=await fetch("/api/i",{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();if(t.error)return(0,d.o)(t.error);await h.startSession({signedUrl:t.apiKey})}catch(e){(0,d.o)("Failed to set up ElevenLabs client :/")}},[h]),f=(0,s.useCallback)(async()=>{await h.endSession()},[h]);return(0,s.useEffect)(()=>()=>{f()},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed top-2 left-2 flex flex-row gap-x-2 items-center",children:(0,n.jsx)("a",{href:"index.html",target:"_blank",children:(0,n.jsx)("img",{loading:"lazy",decoding:"async",src:"https://upload.wikimedia.org/wikipedia/commons/2/28/HDFC_Bank_Logo.svg",width:"158",height:"48",className:"h-[30px] w-auto",alt:"HDFC Bank Logo"})})}),(0,n.jsx)(o,{currentText:t,isAudioPlaying:h.isSpeaking,onStopListening:()=>{"connected"===h.status&&f()},onStartListening:()=>{"connected"!==h.status&&m()}})]})}},4510:(e,t,i)=>{Promise.resolve().then(i.bind(i,3873))}},e=>{var t=t=>e(e.s=t);e.O(0,[401,85,309,951,358],()=>t(4510)),_N_E=e.O()}]);